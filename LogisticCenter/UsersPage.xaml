<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="LogisticCenter.UsersPage"
             BackgroundColor="#121212">

    <Grid Padding="20" RowDefinitions="Auto,Auto,*" RowSpacing="16">


        <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">

            <Label Grid.Column="0"
                Text="ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸"
                FontSize="26"
                FontAttributes="Bold"
                TextColor="White"
                VerticalOptions="Center"
                Margin="12,0,0,0"/>

            <Button Grid.Column="1"
                Text='â†© Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ'
                FontAttributes="Bold"
                Command="{Binding GoBackCommand}"
                BackgroundColor="#1C1C26"
                BorderColor="#00cccc"
                BorderWidth="2"
                TextColor="White"
                CornerRadius="10"
                HeightRequest="44"
                HorizontalOptions="End"/>
            
        </Grid>


        <FlexLayout Grid.Row="1"
            Wrap="Wrap"
            Direction="Row"
            AlignItems="Center"
            JustifyContent="Start">

            <Border Padding="10"
                BackgroundColor="#1C1C26"
                Stroke="#00cccc"
                StrokeThickness="2"
                StrokeShape="RoundRectangle 10"
                FlexLayout.Basis="300"
                FlexLayout.Grow="1"
                HeightRequest="50">

                <Grid ColumnDefinitions="Auto,*">

                    <Button Text="ðŸ”"
                        FontSize="18"
                        TextColor="#00cccc"
                        BackgroundColor="Transparent"
                        Command="{Binding SearchCommand}" 
                        HeightRequest="50"/>

                    <Entry Grid.Column="1"
                       Placeholder="ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸, email Ð¸Ð»Ð¸ Ñ€Ð¾Ð»Ð¸"
                       Text="{Binding SearchText}"
                       Completed="OnSearchCompleted"
                       TextColor="White"
                       PlaceholderColor="#777"
                       BackgroundColor="Transparent"
                       ClearButtonVisibility="WhileEditing"
                       HeightRequest="50"/>
                </Grid>
            </Border>

            <Picker
                
                ItemsSource="{Binding Roles}"
                ItemDisplayBinding="{Binding RoleName}"
                SelectedItem="{Binding SelectedRole}"
                WidthRequest="160"
                HeightRequest="50"
                BackgroundColor="#1C1C26"
                TextColor="White"
                Margin="5,0,5,0"/>



            <Button Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ"
            Command="{Binding AddUserCommand}"
            BackgroundColor="#00cccc"
            TextColor="White"
            CornerRadius="10"
            Margin="5,0,5,0"/>

    <Button Text="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"
            Command="{Binding EditUserCommand}"
            BackgroundColor="#1C1C26"
            BorderColor="#00cccc"
            TextColor="White"
            CornerRadius="10"
            Margin="0,0,5,0"/>

    <Button Text="ÐÐ°Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÑŒ Ñ€Ð¾Ð»ÑŒ"
            Command="{Binding AssignRoleCommand}"
            BackgroundColor="#1C1C26"
            BorderColor="#00cccc"
            TextColor="White"
            CornerRadius="10"
            Margin="0,0,5,0"/>

    <!--<Button Text="Ð—Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"
            Command="{Binding BlockUserCommand}"
            BackgroundColor="#1C1C26"
            TextColor="#FF4D4D"
            CornerRadius="10"/>-->

    <Button Text="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"
            Command="{Binding DeleteUserCommand}"
            BackgroundColor="#FF4D4D"
            TextColor="White"
            CornerRadius="10"/>

</FlexLayout>

        

        <CollectionView Grid.Row="2"
                        ItemsSource="{Binding Users}"
                        SelectionMode="Single"
                        SelectedItem="{Binding SelectedUser}">

            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical"
                     Span="2"
                     VerticalItemSpacing="5"
                     HorizontalItemSpacing="5"/>
            </CollectionView.ItemsLayout>


            <CollectionView.ItemTemplate>
                
                <DataTemplate>

                    <Frame Padding="16"
                        BackgroundColor="#1C1C26"
                           BorderColor="Transparent">

                        <Grid ColumnDefinitions="*,Auto">

                            <VerticalStackLayout Spacing="4">
                                <Label Text="{Binding FullName}"
                                       FontSize="16"
                                       TextColor="White"
                                       FontAttributes="Bold"/>

                                <Label Text="{Binding Email}"
                                       FontSize="13"
                                       TextColor="#C7C7D1"/>


                                <Label Text="{Binding RoleName}"
                                   FontSize="12"
                                   TextColor="#00cccc"/>
                            </VerticalStackLayout>

                            <Label Text="{Binding Status}"
                                   Grid.Column="1"
                                   VerticalOptions="Center"
                                   TextColor="{Binding StatusColor}"
                                   FontAttributes="Bold"/>

                        </Grid>
                    </Frame>

                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>
</ContentPage>
